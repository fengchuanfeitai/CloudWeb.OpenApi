@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <meta charset="UTF-8">
    <title></title>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/Scripts/layui/layui.js"></script>
    <script src="~/Scripts/xadmin.js"></script>
    <link href="~/Scripts/layui/css/layui.css" rel="stylesheet" />
    <link href="~/Content/css/font.css" rel="stylesheet" />
    <link href="~/Content/css/xadmin.css" rel="stylesheet" />
</head>
<body class="login-bg">

    <div class="login">
        <div class="message">-登录</div>
        <div id="darkbannerwrap"></div>
        <form method="post" class="layui-form">
            <input id="username" placeholder="用户名" type="text" lay-verify="username" class="layui-input">
            <hr class="hr15">
            <input id="password" lay-verify="pass" placeholder="密码" type="password" class="layui-input">
            <hr class="hr15">
            <input id="verifyCode" lay-verify="verifyCode" placeholder="验证码" type="text" class="layui-verify" style="width:220px;">
            <img style="height:45px" src="@Url.Action("VerifyImage", "Home")" id="VerifyImage" title="看不清？点击换一个" onclick="javascript:document.getElementById('VerifyImage').src='@Url.Action("VerifyImage", "Home")?r='+Math.random();return false;">
            <hr class="hr15">
            <input value="登录" lay-submit lay-filter="login" onclick="login()" type="button" style="width:100%;">
            <hr class="hr20">
            @Html.ValidationMessage("error")
        </form>
    </div>

    <script>

        //搜索
        function login() {
            //判断
            if ($("#username").val().length <= 0) {
                alertMsg("用户名不能为空");
                return false;
            }

            if ($("#password").val().length <= 0) {
                alertMsg("密码不能为空");
                return false;
            }

            if ($("#verifyCode").val().length <= 0) {
                alertGetCode("验证码不能为空");
                return false;
            }

            //提交
            $.ajax({
                type: "POST",
                async: false,
                url: "/Home/Login",
                data: { username: $("#username").val(), password: $("#password").val(), verifyCode: $("#verifyCode").val() },
                success: function (data) {
                    if (data.IsSuccess) {
                        location.href = "/Home/Index";
                    }
                    else {
                        alertGetCode(data.Msg);
                    }
                }
            });
        }


        //弹出框
        function alertMsg(msg) {
            layer.open({
                content: msg,
                yes: function (index, layero) {
                    layer.close(index);
                }
            });
        }

        //弹出框，刷新二维码
        function alertGetCode(msg) {
            layer.open({
                content: msg,
                yes: function (index, layero) {
                    layer.close(index);
                    $("#VerifyImage").click();
                }
            });
        }

    </script>

</body>
</html>
